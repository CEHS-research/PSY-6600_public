# Mixed ANOVA:  with sphericity tests and corrections
fit_anx_major <- ihno_anx_long %>%
afex::aov_4(anxiety ~ majorF ~ (time|sub_num),
data = .,
anova_table = list(es = c("ges", "pes")))
summary(fit_anx_major)
# Mixed ANOVA: effect sizes
fit_anx_major
# Mixed ANOVA: means plot <-- interaction
fit_anx_major %>%
emmeans::emmip(majorF ~ time,
CIs = TRUE) +
theme_bw()
fit_anx_major %>%
emmeans::emmeans(~ time | majorF) %>%
pairs(adjust = "none")
ihno_hr_long <- ihno_clean %>%
tidyr::pivot_longer(cols = c(hr_base, hr_pre, hr_post),
names_to = "time",
names_prefix = "hr_",
names_ptypes = list(time = factor()),
values_to = "heart_rate")
ihno_hr_long %>%
dplyr::select(sub_num, genderF, time, heart_rate) %>%
psych::headTail()
# Mixe ANOVA:  with sphericity tests and corrections
fit_hr_gender <- ihno_hr_long %>%
afex::aov_4(heart_rate ~ genderF + (time|sub_num),
data = .,
anova_table = list(es = c("ges", "pes")))
summary(fit_hr_gender)
ihno_hr_long %>%
afex::aov_4(heart_rate ~ genderF + (time|sub_num),
data = .,
anova_table = list(correction = "none",
es = c("ges", "pes")))
# Mixed ANOVA: post hoc pairwise tests <-- time
fit_hr_gender %>%
emmeans::emmeans(~ time) %>%
pairs(adjust = "none")
# RM ANOVA: means plot <-- time
fit_hr_gender %>%
emmeans::emmip(~ time,
CIs = TRUE)
ihno_statquiz_long <- ihno_clean %>%
tidyr::pivot_longer(cols = c(statquiz, exp_sqz),
names_to = "quiz_type",
names_ptypes = list(time = factor()),
values_to = "quiz_score") %>%
dplyr::mutate(quiz_type = quiz_type %>%
forcats::fct_recode("Regular" = "statquiz",
"Experimental" = "exp_sqz"))
ihno_statquiz_long %>%
dplyr::select(sub_num, exp_condF, quiz_type, quiz_score) %>%
psych::headTail()
# Mixed ANOVA:  with summary
fit_quiz_cond <- ihno_statquiz_long %>%
afex::aov_4(quiz_score ~ exp_condF + (quiz_type|sub_num),
data = .,
anova_table = list(es = c("ges", "pes")))
fit_quiz_cond
summary(fit_quiz_cond)
# RM ANOVA: means plot <-- interaction
fit_quiz_cond %>%
emmeans::emmip(exp_condF ~ quiz_type,
CIs = TRUE)
fit_quiz_cond %>%
emmeans::emmeans(~ quiz_type*exp_condF) %>%
contrast(list("easy vs other on Exp Quiz" = c(3, 0, -1, 0, -1, 0, -1, 0)))
tasks_wide
# set global chunk options...
#  this changes the defaults so you don't have to repeat yourself
knitr::opts_chunk$set(comment     = NA,
cache       = TRUE,
echo        = TRUE,
error       = FALSE,
warning     = FALSE,
message     = FALSE,
fig.align   = "center", # center all figures
fig.width   = 5,        # set default figure width to 5 inches
fig.height  = 3)        # set default figure height to 3 inches
library(magrittr)     # Forward pipes in R
library(tidyverse)    # Loads several very helpful 'tidy' packages
library(readxl)       # Read in Excel datasets
library(furniture)    # Nice tables (by our own Tyson Barrett)
library(psych)        # Helpful tid-bits
library(afex)         # Analysis of Factorial Experiments
library(emmeans)      # Estimated marginal means (Least-squares means)
tasks_wide <- data.frame(id = 1:5,
clerical_background   = c(10,  7, 13, 18,  6),
clerical_popular      = c(12,  9, 15, 12,  8),
clerical_metal        = c( 8,  4,  9,  6,  3),
mechanical_background = c(15, 19,  8, 10, 16),
mechanical_popular    = c(18, 22, 12, 10, 19),
mechanical_metal      = c(20, 23, 15, 14, 19))
anograms_wide <- data.frame(id = 1:3,
none_5    = c( 9, 10, 12),
none_6    = c( 6,  7,  9),
none_7    = c( 4,  4,  7),
none_8    = c( 2,  3,  5),
alone_5   = c(19, 19, 22),
alone_6   = c(16, 15, 20),
alone_7   = c(15, 11, 17),
alone_8   = c(12, 11, 14),
withEgo_5 = c(30, 31, 34),
withEgo_6 = c(25, 30, 32),
withEgo_7 = c(22, 27, 28),
withEgo_8 = c(21, 23, 24))
brain_wide <- data.frame(id = 1:6,
left_digit   = c( 6,  8,  7,  8,  6,  7),
left_letter  = c( 5,  7,  7,  5,  4,  6),
left_mixed   = c( 6,  5,  4,  8,  7,  5),
right_digit  = c( 9,  8,  9,  7,  7,  9),
right_letter = c( 8,  8,  7,  8,  6,  8),
right_mixed  = c( 6,  7,  8,  8,  7,  9),
none_digit   = c( 8, 10,  9,  9,  8, 10),
none_letter  = c( 8,  9, 10,  7,  8, 10),
none_mixed   = c( 7,  9,  8,  9,  8,  9))
tasks_wide
# Restructure from wide to long format:
tasks_long <- tasks_wide %>%
tidyr::pivot_longer(-id,
names_to     = c("type_task", "noise"),
names_sep    = "_",
names_ptypes = list(type_task = factor(),
noise     = factor()),
values_to    = "completed") %>%
dplyr::mutate(id = paste(id, type_task, sep = "_") %>%
factor()) %>%
dplyr::mutate(type_task = type_task %>%
forcats::fct_recode("Clerical Tasks"   = "clerical",
"Mechanical Tasks" = "mechanical")) %>%
dplyr::mutate(noise = noise %>%
forcats::fct_recode("Background" = "background",
"Popular" = "popular",
"Metal" = "metal"))
psych::headTail(tasks_long)
# Raw data: summary table
tasks_long %>%
tidyr::pivot_wider(names_from  = noise,
values_from = completed) %>%
dplyr::group_by("Type of Task" = type_task) %>%
furniture::table1(Background, Popular, Metal,
total = TRUE,
output = "latex2",
caption = "Descriptives: Performance by Task Type and Noise")
tasks_long %>%
ggplot(aes(x = noise,
y = completed,
group = id)) +
geom_point() +
geom_line() +
facet_grid(.~ type_task) +
theme_bw()+
labs(x = "Type of Noise (Music)",
y = "Number of Tasks Completed")
tasks_long %>%
dplyr::mutate(type_task = forcats::fct_rev(type_task)) %>%
ggplot(aes(x = noise,
y = completed,
group = type_task)) +
stat_summary(aes(shape = type_task),
position = position_dodge(width = .3)) +
stat_summary(aes(linetype = type_task),
fun.y = mean,
geom = "line",
position = position_dodge(width = .3)) +
theme_bw() +
labs(x = "Type of Noise (Music)",
y = "Number of Tasks Completed",
shape = NULL,
linetype = NULL) +
theme(legend.position = c(0, 0),
legend.justification = c(-0.05, -0.1),
legend.background = element_rect(color = "black"),
legend.key.width = unit(2, "cm")) +
scale_linetype_manual(values = c("solid", "longdash")) +
coord_cartesian(ylim = c(3, 20))
# Mixed ANOVA: display all Sums-of-Squares components
# Mixed ANOVA: name the model was saved as
# RM ANOVA: means plot
anograms_wide
anograms_long <- anograms_wide %>%
tidyr::pivot_longer(-id,
names_to     = c("feedback", "difficulty"),
names_sep    = "_",
names_ptypes = list(feedback   = factor(),
difficulty = factor()),
values_to    = "correct") %>%
dplyr::mutate(id = paste(id, feedback, sep = "_") %>%
factor()) %>%
dplyr::mutate(feedback = feedback %>%
forcats::fct_recode("No Feedback"        = "none",
"Only Feedback"      = "alone",
"Feedback and Ego" = "withEgo")) %>%
dplyr::mutate(difficulty = difficulty %>%
forcats::fct_recode("Length 5" = "5",
"Length 6" = "6",
"Length 7" = "7",
"Length 8" = "8"))
psych::headTail(anograms_long)
# Raw data: summary table
anograms_long %>%
tidyr::pivot_wider(names_from   = difficulty,
values_from  = correct) %>%
dplyr::group_by("Randomized Condition" = feedback) %>%
furniture::table1(c(3:6),
total = TRUE,
output = "latex2",
caption = "Descriptives: Performance by Feedback and Difficulty")
anograms_long %>%
ggplot(aes(x = difficulty,
y = correct,
group = id)) +
geom_point() +
geom_line() +
facet_grid(.~ feedback) +
theme_bw() +
labs(x = "Difficulty, Length of Anogram",
y = "Number of Anograms Correct") +
scale_x_discrete(labels = 5:8)
anograms_long %>%
dplyr::mutate(feedback = feedback %>%
forcats::fct_rev()) %>%
ggplot(aes(x = difficulty,
y = correct,
group = feedback)) +
stat_summary(aes(shape = feedback)) +
stat_summary(aes(linetype = feedback),
fun.y = mean,
geom = "line") +
theme_bw() +
labs(x = "Difficulty, Length of Anogram",
y = "Number of Anograms Correct",
shape = NULL,
linetype = NULL) +
theme(legend.position = c(1, 1),
legend.justification = c(1.05, 1.1),
legend.background = element_rect(color = "black"),
legend.key.width = unit(2, "cm")) +
scale_x_discrete(labels = 5:8) +
scale_shape_manual(values = c(15, 19, 17)) +
scale_linetype_manual(values = c("solid", "longdash", "dotted")) +
coord_cartesian(ylim = c(0, 50))
# Mixed ANOVA: display all Sums-of-Squares components
# Mixed ANOVA: sphericity tests and corrections
# Mixed ANOVA: post hoc pairwise tests <-- feedback
# RM ANOVA: means plot <--feedback
# Mixed ANOVA: post hoc pairwise tests <-- difficulty
# RM ANOVA: means plot <-- difficulty
brain_wide
brain_long <-  brain_wide %>%
tidyr::pivot_longer(-id,
names_to = c("damage", "stimuli"),
names_sep = "_",
names_ptypes = list(damage = factor(),
stimuli = factor()),
values_to = "longest_correct") %>%
dplyr::mutate(id = paste(id, damage, sep = "_") %>%
factor()) %>%
dplyr::mutate(damage = damage %>%
forcats::fct_recode("Left" = "left",
"Right" = "right",
"Neither" = "none")) %>%
dplyr::mutate(stimuli = stimuli %>%
forcats::fct_recode("Digits" = "digit",
"Letters" = "letter",
"Mixed" = "mixed"))
psych::headTail(brain_long)
# Raw data: summary table
brain_long %>%
tidyr::pivot_wider(names_from = stimuli,
values_from = longest_correct) %>%
dplyr::select(-id) %>%
dplyr::group_by("Hemisphere of Brain Damage" = damage) %>%
furniture::table1(Digits, Letters, Mixed,
total = TRUE,
output = "latex2",
caption = "Descriptives: Recall by Hemisphere and Stimuli")
brain_long %>%
ggplot(aes(x = stimuli,
y = longest_correct,
group = id)) +
geom_point() +
geom_line() +
facet_grid(.~ damage) +
theme_bw() +
labs(x = "Type of Stimuli",
y = "Longest Sequence Correct")
brain_long %>%
dplyr::mutate(damage = damage %>%
forcats::fct_rev()) %>%
ggplot(aes(x = stimuli,
y = longest_correct,
group = damage)) +
stat_summary(aes(shape = damage)) +
stat_summary(aes(linetype = damage),
fun.y = mean,
geom = "line") +
theme_bw() +
labs(x = "Type of Stimuli",
y = "Longest Sequence Correct",
shape    = "Damaged Hemisphere",
linetype = "Damaged Hemisphere") +
theme(legend.position = c(0, 0),
legend.justification = c(-0.05, -0.1),
legend.background = element_rect(color = "black"),
legend.key.width = unit(2, "cm")) +
scale_shape_manual(values = c(15, 19, 17)) +
scale_linetype_manual(values = c("solid", "longdash", "dotted")) +
coord_cartesian(ylim = c(2, 9.5))
# Mixed ANOVA:  with sphericity tests and corrections
# Mixed ANOVA: post hoc pairwise tests <-- damage
# RM ANOVA: means plot <-- damage
# Mixed ANOVA: post hoc pairwise tests <-- stimuli
# RM ANOVA: means plot <-- stimuli
ihno_clean <- read_excel("Ihno_dataset.xls") %>%
dplyr::rename_all(tolower) %>%
dplyr::mutate(genderF = gender %>%
factor(levels = c(1, 2),
labels = c("Female",
"Male"))) %>%
dplyr::mutate(majorF = major %>%
factor(levels = c(1, 2, 3, 4,5),
labels = c("Psychology",
"Premed",
"Biology",
"Sociology",
"Economics"))) %>%
dplyr::mutate(reasonF = reason %>%
factor(levels = c(1, 2, 3),
labels = c("Program requirement",
"Personal interest",
"Advisor recommendation"))) %>%
dplyr::mutate(exp_condF = exp_cond %>%
factor(levels = c(1, 2, 3, 4),
labels = c("Easy",
"Moderate",
"Difficult",
"Impossible"))) %>%
dplyr::mutate(coffeeF = coffee %>%
factor(levels = c(0, 1),
labels = c("Not a regular coffee drinker",
"Regularly drinks coffee")))
ihno_anx_long <- ihno_clean %>%
tidyr::pivot_longer(cols = c(anx_base, anx_pre, anx_post),
names_to = "time",
names_prefix = "anx_",
names_ptypes = list(time = factor()),
values_to = "anxiety")
ihno_anx_long %>%
dplyr::select(sub_num, majorF, time, anxiety) %>%
psych::headTail()
# Mixed ANOVA:  with sphericity tests and corrections
fit_anx_major <- ihno_anx_long %>%
afex::aov_4(anxiety ~ majorF ~ (time|sub_num),
data = .,
anova_table = list(es = c("ges", "pes")))
summary(fit_anx_major)
# Mixed ANOVA: effect sizes
fit_anx_major
# Mixed ANOVA: means plot <-- interaction
fit_anx_major %>%
emmeans::emmip(majorF ~ time,
CIs = TRUE) +
theme_bw()
fit_anx_major %>%
emmeans::emmeans(~ time | majorF) %>%
pairs(adjust = "none")
ihno_hr_long <- ihno_clean %>%
tidyr::pivot_longer(cols = c(hr_base, hr_pre, hr_post),
names_to = "time",
names_prefix = "hr_",
names_ptypes = list(time = factor()),
values_to = "heart_rate")
ihno_hr_long %>%
dplyr::select(sub_num, genderF, time, heart_rate) %>%
psych::headTail()
# Mixe ANOVA:  with sphericity tests and corrections
fit_hr_gender <- ihno_hr_long %>%
afex::aov_4(heart_rate ~ genderF + (time|sub_num),
data = .,
anova_table = list(es = c("ges", "pes")))
summary(fit_hr_gender)
ihno_hr_long %>%
afex::aov_4(heart_rate ~ genderF + (time|sub_num),
data = .,
anova_table = list(correction = "none",
es = c("ges", "pes")))
# Mixed ANOVA: post hoc pairwise tests <-- time
fit_hr_gender %>%
emmeans::emmeans(~ time) %>%
pairs(adjust = "none")
# RM ANOVA: means plot <-- time
fit_hr_gender %>%
emmeans::emmip(~ time,
CIs = TRUE)
ihno_statquiz_long <- ihno_clean %>%
tidyr::pivot_longer(cols = c(statquiz, exp_sqz),
names_to = "quiz_type",
names_ptypes = list(time = factor()),
values_to = "quiz_score") %>%
dplyr::mutate(quiz_type = quiz_type %>%
forcats::fct_recode("Regular" = "statquiz",
"Experimental" = "exp_sqz"))
ihno_statquiz_long %>%
dplyr::select(sub_num, exp_condF, quiz_type, quiz_score) %>%
psych::headTail()
# Mixed ANOVA:  with summary
fit_quiz_cond <- ihno_statquiz_long %>%
afex::aov_4(quiz_score ~ exp_condF + (quiz_type|sub_num),
data = .,
anova_table = list(es = c("ges", "pes")))
fit_quiz_cond
summary(fit_quiz_cond)
# RM ANOVA: means plot <-- interaction
fit_quiz_cond %>%
emmeans::emmip(exp_condF ~ quiz_type,
CIs = TRUE)
fit_quiz_cond %>%
emmeans::emmeans(~ quiz_type*exp_condF) %>%
contrast(list("easy vs other on Exp Quiz" = c(3, 0, -1, 0, -1, 0, -1, 0)))
tasks_wide
ihno_clean <- read_excel("Ihno_dataset.xls") %>%
dplyr::rename_all(tolower) %>%
dplyr::mutate(genderF = gender %>%
factor(levels = c(1, 2),
labels = c("Female",
"Male"))) %>%
dplyr::mutate(majorF = major %>%
factor(levels = c(1, 2, 3, 4,5),
labels = c("Psychology",
"Premed",
"Biology",
"Sociology",
"Economics"))) %>%
dplyr::mutate(reasonF = reason %>%
factor(levels = c(1, 2, 3),
labels = c("Program requirement",
"Personal interest",
"Advisor recommendation"))) %>%
dplyr::mutate(exp_condF = exp_cond %>%
factor(levels = c(1, 2, 3, 4),
labels = c("Easy",
"Moderate",
"Difficult",
"Impossible"))) %>%
dplyr::mutate(coffeeF = coffee %>%
factor(levels = c(0, 1),
labels = c("Not a regular coffee drinker",
"Regularly drinks coffee")))
ihno_anx_long <- ihno_clean %>%
tidyr::pivot_longer(cols = c(anx_base, anx_pre, anx_post),
names_to = "time",
names_prefix = "anx_",
names_ptypes = list(time = factor()),
values_to = "anxiety")
ihno_anx_long %>%
dplyr::select(sub_num, majorF, time, anxiety) %>%
psych::headTail()
# Mixed ANOVA:  with sphericity tests and corrections
fit_anx_major <- ihno_anx_long %>%
afex::aov_4(anxiety ~ majorF ~ (time|sub_num),
data = .,
anova_table = list(es = c("ges", "pes")))
summary(fit_anx_major)
summary(fit_anx_major)
# RM ANOVA: means plot <-- time
fit_hr_gender %>%
emmeans::emmip(genreF~ time,
CIs = TRUE)
# RM ANOVA: means plot <-- time
fit_hr_gender %>%
emmeans::emmip(genderF~ time,
CIs = TRUE)
# set global chunk options...
#  this changes the defaults so you don't have to repeat yourself
knitr::opts_chunk$set(comment     = NA,
cache       = TRUE,
echo        = TRUE,
error       = FALSE,
warning     = FALSE,
message     = FALSE,
fig.align   = "center", # center all figures
fig.width   = 5,        # set default figure width to 5 inches
fig.height  = 3)        # set default figure height to 3 inches
library(readxl)
library(magrittr)     # Forward pipes in R
library(tidyverse)    # Loads several very helpful 'tidy' packages
library(furniture)    # Nice tables (by our own Tyson Barrett)
library(effectsize)   # effect size calculation
table_soda <- c(X = 27,
Y = 15,
Z = 24) %>%
as.table()
table_season <- c(spring = 30,
summer = 40,
fall   = 20,
winter = 10) %>%
as.table()
table_dx <- c(Schizophrenic = 60,
Depressed     = 30,
Bipolar       = 10) %>%
as.table()
# Run the 1-way chi-square test for equally likely
table_sode
# Run the 1-way chi-square test for equally likely
table_soda
# Run the 1-way chi-square test for equally likely
chisq_soda <- table_soda %>%
chisq.test()
setwd("~/GitHub/PSY-6600_public/assignments")
